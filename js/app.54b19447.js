(function(){"use strict";var e={3847:function(e,n,t){var o=t(5130),i=t(6768);const r={id:"app"};function a(e,n,t,o,a,l){const s=(0,i.g2)("router-view");return(0,i.uX)(),(0,i.CE)("div",r,[(0,i.bF)(s)])}var l={name:"App"},s=t(1241);const c=(0,s.A)(l,[["render",a]]);var d=c,u=t(1387),h=t(4232),m=t.p+"img/logo-yara.3f144c98.jpeg";const f=e=>((0,i.Qi)("data-v-0f315f7e"),e=e(),(0,i.jt)(),e),p={key:0},v={class:"py-2 bg-body-tertiary border-bottom"},g={class:"container d-flex flex-wrap"},w={class:"nav me-auto"},b={class:"nav-item"},k={href:"#",class:"nav-link link-body-emphasis px-2 active","aria-current":"page"},L={class:"nav"},y={class:"nav-item"},A={class:"vh-100 d-flex flex-column justify-content-center align-items-center"},C={style:{width:"25rem"}},U={class:"card-body"},O={key:0},x={class:"mt-4"},E=f((()=>(0,i.Lk)("p",{class:"text-start"},"Cargar ficheros por URL:",-1))),R=["disabled"],D=f((()=>(0,i.Lk)("br",null,null,-1))),F=f((()=>(0,i.Lk)("br",null,null,-1))),V=f((()=>(0,i.Lk)("p",{class:"text-start mt-4"},"Ficheros de OneDrive:",-1))),j={key:0,class:"mt-2"},_=f((()=>(0,i.Lk)("i",{class:"bi bi-caret-down-fill"},null,-1))),S={class:"list-unstyled"},X=["onClick"],I={key:1},z=f((()=>(0,i.Lk)("img",{class:"img-fluid",src:m},null,-1))),M=f((()=>(0,i.Lk)("h1",{class:"mb-5"},"Visor VR",-1))),P=f((()=>(0,i.Lk)("br",null,null,-1))),B=f((()=>(0,i.Lk)("br",null,null,-1)));function H(e,n,t,r,a,l){return(0,i.uX)(),(0,i.CE)(i.FK,null,[a.isAuthenticated?((0,i.uX)(),(0,i.CE)("div",p,[(0,i.Lk)("nav",v,[(0,i.Lk)("div",g,[(0,i.Lk)("ul",w,[(0,i.Lk)("li",b,[(0,i.Lk)("a",k,(0,h.v_)(a.welcome)+", "+(0,h.v_)(a.username),1)])]),(0,i.Lk)("ul",L,[(0,i.Lk)("li",y,[(0,i.Lk)("a",{href:"#",class:"nav-link link-body-emphasis px-2",onClick:n[0]||(n[0]=(...e)=>l.logout&&l.logout(...e))},"Logout")])])])])])):(0,i.Q3)("",!0),(0,i.Lk)("div",A,[(0,i.Lk)("div",C,[(0,i.Lk)("div",U,[a.isAuthenticated?((0,i.uX)(),(0,i.CE)("div",O,[(0,i.Lk)("div",x,[E,(0,i.bo)((0,i.Lk)("input",{type:"text","onUpdate:modelValue":n[1]||(n[1]=e=>a.modelUrl=e),class:"form-control",placeholder:"Introduzca aquÃ­ la URL del fichero"},null,512),[[o.Jo,a.modelUrl]]),(0,i.Lk)("button",{class:"btn btn-success mt-2 w-100",disabled:!a.modelUrl,onClick:n[2]||(n[2]=e=>l.load3DModel(a.modelUrl))},"Visualizar fichero",8,R)]),D,F,V,(0,i.Lk)("button",{class:"btn btn-primary w-100",onClick:n[3]||(n[3]=(...e)=>l.getOneDriveFiles&&l.getOneDriveFiles(...e))},"Obtener ficheros de OneDrive"),a.models.length>0?((0,i.uX)(),(0,i.CE)("div",j,[_,(0,i.Lk)("ul",S,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(a.models,(e=>((0,i.uX)(),(0,i.CE)("li",{key:e.id},[(0,i.Lk)("button",{class:"btn btn-success mt-2 model-button w-100",onClick:n=>l.load3DModel(e.downloadUrl)},(0,h.v_)(e.name),9,X)])))),128))])])):(0,i.Q3)("",!0)])):(0,i.Q3)("",!0),a.isAuthenticated?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("div",I,[z,M,P,B,(0,i.Lk)("button",{class:"btn btn-primary w-100 mt-2",onClick:n[4]||(n[4]=(...e)=>l.login&&l.login(...e))},"Login")]))])])])],64)}t(4114);var Q=t(75);const T={auth:{clientId:"f51206fa-fd71-4af6-b2cf-a467b04b294d",authority:"https://login.microsoftonline.com/e08d22db-a9ec-477d-a620-7f8ae4254949",redirectUri:"https://dareplanetshuttle.github.io/VR-OneDrive/"},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!0}},q=new Q.vq(T),W=async()=>{await q.initialize()};var Z=q,$={name:"HomeView",data(){return{isAuthenticated:!1,username:"",modelUrl:"",models:[],welcome:"Bienvenido"}},async created(){await W(),this.checkAccount()},methods:{async login(){try{const e=await Z.loginPopup({scopes:["User.Read","Files.Read"]});this.handleResponse(e)}catch(e){console.error("Login failed:",e)}},logout(){Z.logoutPopup(),this.isAuthenticated=!1,this.username="",this.models=[]},handleResponse(e){if(e)this.isAuthenticated=!0,this.username=e.account.name;else{const e=Z.getAllAccounts();1===e.length&&(this.isAuthenticated=!0,this.username=e[0].name)}},checkAccount(){const e=Z.getAllAccounts();1===e.length&&(this.isAuthenticated=!0,this.username=e[0].name)},async getOneDriveFiles(){try{const e=Z.getAllAccounts()[0],{accessToken:n}=await Z.acquireTokenSilent({scopes:["Files.Read"],account:e}),t=await fetch("https://graph.microsoft.com/v1.0/me/drive/root:/models:/children",{headers:{Authorization:`Bearer ${n}`}});if(t.ok){const e=await t.json();this.models=e.value.map((e=>({id:e.id,name:e.name,downloadUrl:e["@microsoft.graph.downloadUrl"]})))}else console.error("Error fetching OneDrive files:",t.statusText)}catch(e){console.error("Error acquiring token or fetching files:",e)}},async load3DModel(e){e?(localStorage.setItem("modelUrl",e),this.$router.push({name:"model-viewer"})):console.error("Failed to load the model URL")}}};const J=(0,s.A)($,[["render",H],["__scopeId","data-v-0f315f7e"]]);var K=J;const N={ref:"vrContainer",class:"vr-container"};function G(e,n,t,o,r,a){return(0,i.uX)(),(0,i.CE)("div",N,null,512)}var Y=t(8776),ee=t(1353),ne=t(4005),te=t(2951),oe={name:"VRModelViewer",data(){return{modelUrl:null}},mounted(){this.modelUrl=localStorage.getItem("modelUrl"),console.log(this.modelUrl),this.modelUrl?this.initVRScene():console.error("No model URL found.")},methods:{initVRScene(){const e=this.$refs.vrContainer,n=new Y.Z58,t=new Y.ubm(70,window.innerWidth/window.innerHeight,.1,1e3),o=new Y.JeP({antialias:!0});o.setSize(window.innerWidth,window.innerHeight),o.xr.enabled=!0,e.appendChild(o.domElement),e.appendChild(ne.Z.createButton(o)),t.position.set(0,10,10);const i=new Y.dth(16777215,12303359,2);i.position.set(.5,1,.25),n.add(i);const r=new ee.B;r.load(this.modelUrl,(e=>{const t=e.scene;t.position.set(0,1.6,0),n.add(t)}),void 0,(e=>{console.error("An error occurred while loading the GLB model:",e)}));const a=new te.N(t,o.domElement);a.enableDamping=!0,a.dampingFactor=.25,a.enableZoom=!0;const l=()=>{o.setAnimationLoop((()=>{a.update(),o.render(n,t)}))};l(),window.addEventListener("resize",(()=>{t.aspect=window.innerWidth/window.innerHeight,t.updateProjectionMatrix(),o.setSize(window.innerWidth,window.innerHeight)}))}}};const ie=(0,s.A)(oe,[["render",G],["__scopeId","data-v-f5b53836"]]);var re=ie;const ae=[{path:"/",component:K},{path:"/scene",name:"model-viewer",component:re}],le=(0,u.aE)({history:(0,u.LA)("/VR-OneDrive/"),routes:ae});var se=le;(0,o.Ef)(d).use(se).mount("#app")}},n={};function t(o){var i=n[o];if(void 0!==i)return i.exports;var r=n[o]={exports:{}};return e[o].call(r.exports,r,r.exports,t),r.exports}t.m=e,function(){var e=[];t.O=function(n,o,i,r){if(!o){var a=1/0;for(d=0;d<e.length;d++){o=e[d][0],i=e[d][1],r=e[d][2];for(var l=!0,s=0;s<o.length;s++)(!1&r||a>=r)&&Object.keys(t.O).every((function(e){return t.O[e](o[s])}))?o.splice(s--,1):(l=!1,r<a&&(a=r));if(l){e.splice(d--,1);var c=i();void 0!==c&&(n=c)}}return n}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[o,i,r]}}(),function(){t.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(n,{a:n}),n}}(),function(){t.d=function(e,n){for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)}}(),function(){t.p="/VR-OneDrive/"}(),function(){var e={524:0};t.O.j=function(n){return 0===e[n]};var n=function(n,o){var i,r,a=o[0],l=o[1],s=o[2],c=0;if(a.some((function(n){return 0!==e[n]}))){for(i in l)t.o(l,i)&&(t.m[i]=l[i]);if(s)var d=s(t)}for(n&&n(o);c<a.length;c++)r=a[c],t.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return t.O(d)},o=self["webpackChunkmicrosoft_onedrive"]=self["webpackChunkmicrosoft_onedrive"]||[];o.forEach(n.bind(null,0)),o.push=n.bind(null,o.push.bind(o))}();var o=t.O(void 0,[504],(function(){return t(3847)}));o=t.O(o)})();
//# sourceMappingURL=app.54b19447.js.map