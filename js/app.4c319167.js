(function(){"use strict";var e={8964:function(e,t,n){var o=n(5130),i=n(6768),r=n(4232);const a={id:"app"};function l(e,t,n,o,l,s){const c=(0,i.g2)("router-view");return(0,i.uX)(),(0,i.CE)("div",a,[(0,i.eW)((0,r.v_)(l.welcome)+" ",1),(0,i.bF)(c)])}var s={name:"App",data(){return{welcome:{NODE_ENV:"production",VUE_APP_AUTHORITY:"https://login.microsoftonline.com/e08d22db-a9ec-477d-a620-7f8ae4254949",VUE_APP_CLIENT_ID:"f51206fa-fd71-4af6-b2cf-a467b04b294d",VUE_APP_REDIRECT_URI:"http://localhost:8080/tabs/validate",BASE_URL:"/VR-OneDrive/"}.VUE_APP_WELCOME||"hola"}}},c=n(1241);const d=(0,c.A)(s,[["render",l]]);var u=d,h=n(1387),m=n.p+"img/logo-yara.3f144c98.jpeg";const f=e=>((0,i.Qi)("data-v-0f315f7e"),e=e(),(0,i.jt)(),e),p={key:0},v={class:"py-2 bg-body-tertiary border-bottom"},b={class:"container d-flex flex-wrap"},w={class:"nav me-auto"},g={class:"nav-item"},k={href:"#",class:"nav-link link-body-emphasis px-2 active","aria-current":"page"},L={class:"nav"},E={class:"nav-item"},A={class:"vh-100 d-flex flex-column justify-content-center align-items-center"},U={style:{width:"25rem"}},_={class:"card-body"},y={key:0},C={class:"mt-4"},O=f((()=>(0,i.Lk)("p",{class:"text-start"},"Cargar ficheros por URL:",-1))),R=["disabled"],V=f((()=>(0,i.Lk)("br",null,null,-1))),P=f((()=>(0,i.Lk)("br",null,null,-1))),D=f((()=>(0,i.Lk)("p",{class:"text-start mt-4"},"Ficheros de OneDrive:",-1))),I={key:0,class:"mt-2"},x=f((()=>(0,i.Lk)("i",{class:"bi bi-caret-down-fill"},null,-1))),T={class:"list-unstyled"},F=["onClick"],j={key:1},S=f((()=>(0,i.Lk)("img",{class:"img-fluid",src:m},null,-1))),X=f((()=>(0,i.Lk)("h1",{class:"mb-5"},"Visor VR",-1))),M=f((()=>(0,i.Lk)("br",null,null,-1))),N=f((()=>(0,i.Lk)("br",null,null,-1)));function z(e,t,n,a,l,s){return(0,i.uX)(),(0,i.CE)(i.FK,null,[l.isAuthenticated?((0,i.uX)(),(0,i.CE)("div",p,[(0,i.Lk)("nav",v,[(0,i.Lk)("div",b,[(0,i.Lk)("ul",w,[(0,i.Lk)("li",g,[(0,i.Lk)("a",k,(0,r.v_)(l.welcome)+", "+(0,r.v_)(l.username),1)])]),(0,i.Lk)("ul",L,[(0,i.Lk)("li",E,[(0,i.Lk)("a",{href:"#",class:"nav-link link-body-emphasis px-2",onClick:t[0]||(t[0]=(...e)=>s.logout&&s.logout(...e))},"Logout")])])])])])):(0,i.Q3)("",!0),(0,i.Lk)("div",A,[(0,i.Lk)("div",U,[(0,i.Lk)("div",_,[l.isAuthenticated?((0,i.uX)(),(0,i.CE)("div",y,[(0,i.Lk)("div",C,[O,(0,i.bo)((0,i.Lk)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>l.modelUrl=e),class:"form-control",placeholder:"Introduzca aquÃ­ la URL del fichero"},null,512),[[o.Jo,l.modelUrl]]),(0,i.Lk)("button",{class:"btn btn-success mt-2 w-100",disabled:!l.modelUrl,onClick:t[2]||(t[2]=e=>s.load3DModel(l.modelUrl))},"Visualizar fichero",8,R)]),V,P,D,(0,i.Lk)("button",{class:"btn btn-primary w-100",onClick:t[3]||(t[3]=(...e)=>s.getOneDriveFiles&&s.getOneDriveFiles(...e))},"Obtener ficheros de OneDrive"),l.models.length>0?((0,i.uX)(),(0,i.CE)("div",I,[x,(0,i.Lk)("ul",T,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(l.models,(e=>((0,i.uX)(),(0,i.CE)("li",{key:e.id},[(0,i.Lk)("button",{class:"btn btn-success mt-2 model-button w-100",onClick:t=>s.load3DModel(e.downloadUrl)},(0,r.v_)(e.name),9,F)])))),128))])])):(0,i.Q3)("",!0)])):(0,i.Q3)("",!0),l.isAuthenticated?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("div",j,[S,X,M,N,(0,i.Lk)("button",{class:"btn btn-primary w-100 mt-2",onClick:t[4]||(t[4]=(...e)=>s.login&&s.login(...e))},"Login")]))])])])],64)}n(4114);var H=n(75);const W={auth:{clientId:"f51206fa-fd71-4af6-b2cf-a467b04b294d",authority:"https://login.microsoftonline.com/e08d22db-a9ec-477d-a620-7f8ae4254949",redirectUri:"http://localhost:8080/tabs/validate"},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!0}},B=new H.vq(W),Q=async()=>{await B.initialize()};var q=B,Z={name:"HomeView",data(){return{isAuthenticated:!1,username:"",modelUrl:"",models:[],welcome:{NODE_ENV:"production",VUE_APP_AUTHORITY:"https://login.microsoftonline.com/e08d22db-a9ec-477d-a620-7f8ae4254949",VUE_APP_CLIENT_ID:"f51206fa-fd71-4af6-b2cf-a467b04b294d",VUE_APP_REDIRECT_URI:"http://localhost:8080/tabs/validate",BASE_URL:"/VR-OneDrive/"}.VUE_APP_WELCOME}},async created(){await Q(),this.checkAccount()},methods:{async login(){try{const e=await q.loginPopup({scopes:["User.Read","Files.Read"]});this.handleResponse(e)}catch(e){console.error("Login failed:",e)}},logout(){q.logoutPopup(),this.isAuthenticated=!1,this.username="",this.models=[]},handleResponse(e){if(e)this.isAuthenticated=!0,this.username=e.account.name;else{const e=q.getAllAccounts();1===e.length&&(this.isAuthenticated=!0,this.username=e[0].name)}},checkAccount(){const e=q.getAllAccounts();1===e.length&&(this.isAuthenticated=!0,this.username=e[0].name)},async getOneDriveFiles(){try{const e=q.getAllAccounts()[0],{accessToken:t}=await q.acquireTokenSilent({scopes:["Files.Read"],account:e}),n=await fetch("https://graph.microsoft.com/v1.0/me/drive/root:/models:/children",{headers:{Authorization:`Bearer ${t}`}});if(n.ok){const e=await n.json();this.models=e.value.map((e=>({id:e.id,name:e.name,downloadUrl:e["@microsoft.graph.downloadUrl"]})))}else console.error("Error fetching OneDrive files:",n.statusText)}catch(e){console.error("Error acquiring token or fetching files:",e)}},async load3DModel(e){e?(localStorage.setItem("modelUrl",e),this.$router.push({name:"model-viewer"})):console.error("Failed to load the model URL")}}};const $=(0,c.A)(Z,[["render",z],["__scopeId","data-v-0f315f7e"]]);var J=$;const K={ref:"vrContainer",class:"vr-container"};function Y(e,t,n,o,r,a){return(0,i.uX)(),(0,i.CE)("div",K,null,512)}var G=n(8776),ee=n(1353),te=n(4005),ne=n(2951),oe={name:"VRModelViewer",data(){return{modelUrl:null}},mounted(){this.modelUrl=localStorage.getItem("modelUrl"),console.log(this.modelUrl),this.modelUrl?this.initVRScene():console.error("No model URL found.")},methods:{initVRScene(){const e=this.$refs.vrContainer,t=new G.Z58,n=new G.ubm(70,window.innerWidth/window.innerHeight,.1,1e3),o=new G.JeP({antialias:!0});o.setSize(window.innerWidth,window.innerHeight),o.xr.enabled=!0,e.appendChild(o.domElement),e.appendChild(te.Z.createButton(o)),n.position.set(0,10,10);const i=new G.dth(16777215,12303359,2);i.position.set(.5,1,.25),t.add(i);const r=new ee.B;r.load(this.modelUrl,(e=>{const n=e.scene;n.position.set(0,1.6,0),t.add(n)}),void 0,(e=>{console.error("An error occurred while loading the GLB model:",e)}));const a=new ne.N(n,o.domElement);a.enableDamping=!0,a.dampingFactor=.25,a.enableZoom=!0;const l=()=>{o.setAnimationLoop((()=>{a.update(),o.render(t,n)}))};l(),window.addEventListener("resize",(()=>{n.aspect=window.innerWidth/window.innerHeight,n.updateProjectionMatrix(),o.setSize(window.innerWidth,window.innerHeight)}))}}};const ie=(0,c.A)(oe,[["render",Y],["__scopeId","data-v-f5b53836"]]);var re=ie;const ae=[{path:"/",component:J},{path:"/scene",name:"model-viewer",component:re}],le=(0,h.aE)({history:(0,h.LA)("/VR-OneDrive/"),routes:ae});var se=le;(0,o.Ef)(u).use(se).mount("#app")}},t={};function n(o){var i=t[o];if(void 0!==i)return i.exports;var r=t[o]={exports:{}};return e[o].call(r.exports,r,r.exports,n),r.exports}n.m=e,function(){var e=[];n.O=function(t,o,i,r){if(!o){var a=1/0;for(d=0;d<e.length;d++){o=e[d][0],i=e[d][1],r=e[d][2];for(var l=!0,s=0;s<o.length;s++)(!1&r||a>=r)&&Object.keys(n.O).every((function(e){return n.O[e](o[s])}))?o.splice(s--,1):(l=!1,r<a&&(a=r));if(l){e.splice(d--,1);var c=i();void 0!==c&&(t=c)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[o,i,r]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.p="/VR-OneDrive/"}(),function(){var e={524:0};n.O.j=function(t){return 0===e[t]};var t=function(t,o){var i,r,a=o[0],l=o[1],s=o[2],c=0;if(a.some((function(t){return 0!==e[t]}))){for(i in l)n.o(l,i)&&(n.m[i]=l[i]);if(s)var d=s(n)}for(t&&t(o);c<a.length;c++)r=a[c],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(d)},o=self["webpackChunkmicrosoft_onedrive"]=self["webpackChunkmicrosoft_onedrive"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[504],(function(){return n(8964)}));o=n.O(o)})();
//# sourceMappingURL=app.4c319167.js.map