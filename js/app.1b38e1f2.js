(function(){"use strict";var e={6761:function(e,t,n){var o=n(5130),i=n(6768);const r={id:"app"};function a(e,t,n,o,a,s){const l=(0,i.g2)("router-view");return(0,i.uX)(),(0,i.CE)("div",r,[(0,i.bF)(l)])}var s={name:"App"},l=n(1241);const c=(0,l.A)(s,[["render",a]]);var d=c,u=n(1387),h=n(4232),m=n.p+"img/logo-yara2.51f212e6.jpg";const f=e=>((0,i.Qi)("data-v-21ab675c"),e=e(),(0,i.jt)(),e),v={class:"global-div"},p={key:0},b={class:"py-2 bg-body-tertiary border-bottom"},g={class:"container d-flex flex-wrap"},w={class:"nav me-auto"},k={class:"nav-item"},L={href:"#",class:"nav-link link-body-emphasis px-2 active","aria-current":"page"},y={class:"nav"},A={class:"nav-item"},C={class:"vh-100 d-flex flex-column justify-content-center align-items-center"},U={key:0,style:{width:"25rem"},class:"mb-3"},O={style:{width:"25rem"},class:"login-div"},x={class:"card-body"},E={key:0},R={class:"mt-4"},D=f((()=>(0,i.Lk)("p",{class:"text-start"},"Cargar ficheros por URL:",-1))),V=["disabled"],j=f((()=>(0,i.Lk)("br",null,null,-1))),F=f((()=>(0,i.Lk)("br",null,null,-1))),_=f((()=>(0,i.Lk)("p",{class:"text-start mt-4"},"Ficheros de OneDrive:",-1))),X={key:0,class:"mt-2"},S=f((()=>(0,i.Lk)("i",{class:"bi bi-caret-down-fill"},null,-1))),I={class:"list-unstyled"},M=["onClick"],z={key:1},P=f((()=>(0,i.Lk)("img",{class:"img-fluid mb-3",src:m},null,-1))),Q=f((()=>(0,i.Lk)("h4",{class:"text-center mb-5 fw-bold"},"· Visor de Realidad Virtual ·",-1))),B=f((()=>(0,i.Lk)("p",null,"Pulse el siguiente botón para conectarse con su cuenta Microsoft:",-1)));function H(e,t,n,r,a,s){return(0,i.uX)(),(0,i.CE)("div",v,[a.isAuthenticated?((0,i.uX)(),(0,i.CE)("div",p,[(0,i.Lk)("nav",b,[(0,i.Lk)("div",g,[(0,i.Lk)("ul",w,[(0,i.Lk)("li",k,[(0,i.Lk)("a",L,(0,h.v_)(a.welcome)+", "+(0,h.v_)(a.username),1)])]),(0,i.Lk)("ul",y,[(0,i.Lk)("li",A,[(0,i.Lk)("a",{href:"#",class:"nav-link link-body-emphasis px-2",onClick:t[0]||(t[0]=(...e)=>s.logout&&s.logout(...e))},"Logout")])])])])])):(0,i.Q3)("",!0),(0,i.Lk)("div",C,[a.isAuthenticated?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("div",U)),(0,i.Lk)("div",O,[(0,i.Lk)("div",x,[a.isAuthenticated?((0,i.uX)(),(0,i.CE)("div",E,[(0,i.Lk)("div",R,[D,(0,i.bo)((0,i.Lk)("input",{type:"text","onUpdate:modelValue":t[1]||(t[1]=e=>a.modelUrl=e),class:"form-control",placeholder:"Introduzca aquí la URL del fichero"},null,512),[[o.Jo,a.modelUrl]]),(0,i.Lk)("button",{class:"btn btn-success mt-2 w-100",disabled:!a.modelUrl,onClick:t[2]||(t[2]=e=>s.load3DModel(a.modelUrl))},"Visualizar fichero",8,V)]),j,F,_,(0,i.Lk)("button",{class:"btn btn-primary w-100",onClick:t[3]||(t[3]=(...e)=>s.getOneDriveFiles&&s.getOneDriveFiles(...e))},"Obtener ficheros de OneDrive"),a.models.length>0?((0,i.uX)(),(0,i.CE)("div",X,[S,(0,i.Lk)("ul",I,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(a.models,(e=>((0,i.uX)(),(0,i.CE)("li",{key:e.id},[(0,i.Lk)("button",{class:"btn btn-success mt-2 model-button w-100",onClick:t=>s.load3DModel(e.downloadUrl)},(0,h.v_)(e.name),9,M)])))),128))])])):(0,i.Q3)("",!0)])):(0,i.Q3)("",!0),a.isAuthenticated?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("div",z,[P,Q,B,(0,i.Lk)("button",{class:"btn btn-primary w-100",onClick:t[4]||(t[4]=(...e)=>s.login&&s.login(...e))},"Login con cuenta Microsoft")]))])])])])}n(4114);var T=n(75);const q={auth:{clientId:"f51206fa-fd71-4af6-b2cf-a467b04b294d",authority:"https://login.microsoftonline.com/e08d22db-a9ec-477d-a620-7f8ae4254949",redirectUri:"https://dareplanetshuttle.github.io/VR-OneDrive/tabs/validate"},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!0}},W=new T.vq(q),Z=async()=>{await W.initialize()};var $=W,J={name:"HomeView",data(){return{isAuthenticated:!1,username:"",modelUrl:"",models:[],welcome:"Bienvenido"}},async created(){await Z(),this.checkAccount()},methods:{async login(){try{const e=await $.loginPopup({scopes:["User.Read","Files.Read"]});this.handleResponse(e)}catch(e){console.error("Login failed:",e)}},logout(){$.logoutPopup(),this.isAuthenticated=!1,this.username="",this.models=[]},handleResponse(e){if(e)this.isAuthenticated=!0,this.username=e.account.name;else{const e=$.getAllAccounts();1===e.length&&(this.isAuthenticated=!0,this.username=e[0].name)}},checkAccount(){const e=$.getAllAccounts();1===e.length&&(this.isAuthenticated=!0,this.username=e[0].name)},async getOneDriveFiles(){try{const e=$.getAllAccounts()[0],{accessToken:t}=await $.acquireTokenSilent({scopes:["Files.Read"],account:e}),n=await fetch("https://graph.microsoft.com/v1.0/me/drive/root:/models:/children",{headers:{Authorization:`Bearer ${t}`}});if(n.ok){const e=await n.json();this.models=e.value.map((e=>({id:e.id,name:e.name,downloadUrl:e["@microsoft.graph.downloadUrl"]})))}else console.error("Error fetching OneDrive files:",n.statusText)}catch(e){console.error("Error acquiring token or fetching files:",e)}},async load3DModel(e){e?(localStorage.setItem("modelUrl",e),this.$router.push({name:"model-viewer"})):console.error("Failed to load the model URL")}}};const N=(0,l.A)(J,[["render",H],["__scopeId","data-v-21ab675c"]]);var G=N;const K={ref:"vrContainer",class:"vr-container"};function Y(e,t,n,o,r,a){return(0,i.uX)(),(0,i.CE)("div",K,null,512)}var ee=n(8776),te=n(1353),ne=n(4005),oe=n(2951),ie={name:"VRModelViewer",data(){return{modelUrl:null}},mounted(){this.modelUrl=localStorage.getItem("modelUrl"),console.log(this.modelUrl),this.modelUrl?this.initVRScene():console.error("No model URL found.")},methods:{initVRScene(){const e=this.$refs.vrContainer,t=new ee.Z58,n=new ee.ubm(70,window.innerWidth/window.innerHeight,.1,1e3),o=new ee.JeP({antialias:!0});o.setSize(window.innerWidth,window.innerHeight),o.xr.enabled=!0,e.appendChild(o.domElement),e.appendChild(ne.Z.createButton(o)),n.position.set(0,10,10);const i=new ee.dth(16777215,12303359,2);i.position.set(.5,1,.25),t.add(i);const r=new te.B;r.load(this.modelUrl,(e=>{const n=e.scene;n.position.set(0,1.6,0),t.add(n)}),void 0,(e=>{console.error("An error occurred while loading the GLB model:",e)}));const a=new oe.N(n,o.domElement);a.enableDamping=!0,a.dampingFactor=.25,a.enableZoom=!0;const s=()=>{o.setAnimationLoop((()=>{a.update(),o.render(t,n)}))};s(),window.addEventListener("resize",(()=>{n.aspect=window.innerWidth/window.innerHeight,n.updateProjectionMatrix(),o.setSize(window.innerWidth,window.innerHeight)}))}}};const re=(0,l.A)(ie,[["render",Y],["__scopeId","data-v-f5b53836"]]);var ae=re;const se=[{path:"/",component:G},{path:"/scene",name:"model-viewer",component:ae}],le=(0,u.aE)({history:(0,u.LA)("/VR-OneDrive/"),routes:se});var ce=le;(0,o.Ef)(d).use(ce).mount("#app")}},t={};function n(o){var i=t[o];if(void 0!==i)return i.exports;var r=t[o]={exports:{}};return e[o].call(r.exports,r,r.exports,n),r.exports}n.m=e,function(){var e=[];n.O=function(t,o,i,r){if(!o){var a=1/0;for(d=0;d<e.length;d++){o=e[d][0],i=e[d][1],r=e[d][2];for(var s=!0,l=0;l<o.length;l++)(!1&r||a>=r)&&Object.keys(n.O).every((function(e){return n.O[e](o[l])}))?o.splice(l--,1):(s=!1,r<a&&(a=r));if(s){e.splice(d--,1);var c=i();void 0!==c&&(t=c)}}return t}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[o,i,r]}}(),function(){n.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return n.d(t,{a:t}),t}}(),function(){n.d=function(e,t){for(var o in t)n.o(t,o)&&!n.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:t[o]})}}(),function(){n.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)}}(),function(){n.p="/VR-OneDrive/"}(),function(){var e={524:0};n.O.j=function(t){return 0===e[t]};var t=function(t,o){var i,r,a=o[0],s=o[1],l=o[2],c=0;if(a.some((function(t){return 0!==e[t]}))){for(i in s)n.o(s,i)&&(n.m[i]=s[i]);if(l)var d=l(n)}for(t&&t(o);c<a.length;c++)r=a[c],n.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return n.O(d)},o=self["webpackChunkmicrosoft_onedrive"]=self["webpackChunkmicrosoft_onedrive"]||[];o.forEach(t.bind(null,0)),o.push=t.bind(null,o.push.bind(o))}();var o=n.O(void 0,[504],(function(){return n(6761)}));o=n.O(o)})();
//# sourceMappingURL=app.1b38e1f2.js.map