(function(){"use strict";var e={7179:function(e,n,t){var o=t(5130),i=t(6768),r=t(4232);const s={id:"app"};function l(e,n,t,o,l,a){const c=(0,i.g2)("router-view");return(0,i.uX)(),(0,i.CE)("div",s,[(0,i.eW)((0,r.v_)(l.welcome)+" ",1),(0,i.bF)(c)])}var a={name:"App",data(){return{welcome:"secrets.VUE_APP_WELCOME"}}},c=t(1241);const d=(0,c.A)(a,[["render",l]]);var u=d,h=t(1387),m=t.p+"img/logo-yara.3f144c98.jpeg";const f=e=>((0,i.Qi)("data-v-38ce1a3f"),e=e(),(0,i.jt)(),e),v={key:0},p={class:"py-2 bg-body-tertiary border-bottom"},w={class:"container d-flex flex-wrap"},g={class:"nav me-auto"},k={class:"nav-item"},b={href:"#",class:"nav-link link-body-emphasis px-2 active","aria-current":"page"},L={class:"nav"},y={class:"nav-item"},A={class:"vh-100 d-flex flex-column justify-content-center align-items-center"},E={style:{width:"25rem"}},U={class:"card-body"},C={key:0},_={class:"mt-4"},O=f((()=>(0,i.Lk)("p",{class:"text-start"},"Cargar ficheros por URL:",-1))),R=["disabled"],x=f((()=>(0,i.Lk)("br",null,null,-1))),P=f((()=>(0,i.Lk)("br",null,null,-1))),V=f((()=>(0,i.Lk)("p",{class:"text-start mt-4"},"Ficheros de OneDrive:",-1))),D={key:0,class:"mt-2"},I=f((()=>(0,i.Lk)("i",{class:"bi bi-caret-down-fill"},null,-1))),F={class:"list-unstyled"},j=["onClick"],S={key:1},T=f((()=>(0,i.Lk)("img",{class:"img-fluid",src:m},null,-1))),X={class:"mb-5"},M=f((()=>(0,i.Lk)("br",null,null,-1))),z=f((()=>(0,i.Lk)("br",null,null,-1)));function W(e,n,t,s,l,a){return(0,i.uX)(),(0,i.CE)(i.FK,null,[l.isAuthenticated?((0,i.uX)(),(0,i.CE)("div",v,[(0,i.Lk)("nav",p,[(0,i.Lk)("div",w,[(0,i.Lk)("ul",g,[(0,i.Lk)("li",k,[(0,i.Lk)("a",b,(0,r.v_)(l.welcome)+", "+(0,r.v_)(l.username),1)])]),(0,i.Lk)("ul",L,[(0,i.Lk)("li",y,[(0,i.Lk)("a",{href:"#",class:"nav-link link-body-emphasis px-2",onClick:n[0]||(n[0]=(...e)=>a.logout&&a.logout(...e))},"Logout")])])])])])):(0,i.Q3)("",!0),(0,i.Lk)("div",A,[(0,i.Lk)("div",E,[(0,i.Lk)("div",U,[l.isAuthenticated?((0,i.uX)(),(0,i.CE)("div",C,[(0,i.Lk)("div",_,[O,(0,i.bo)((0,i.Lk)("input",{type:"text","onUpdate:modelValue":n[1]||(n[1]=e=>l.modelUrl=e),class:"form-control",placeholder:"Introduzca aquÃ­ la URL del fichero"},null,512),[[o.Jo,l.modelUrl]]),(0,i.Lk)("button",{class:"btn btn-success mt-2 w-100",disabled:!l.modelUrl,onClick:n[2]||(n[2]=e=>a.load3DModel(l.modelUrl))},"Visualizar fichero",8,R)]),x,P,V,(0,i.Lk)("button",{class:"btn btn-primary w-100",onClick:n[3]||(n[3]=(...e)=>a.getOneDriveFiles&&a.getOneDriveFiles(...e))},"Obtener ficheros de OneDrive"),l.models.length>0?((0,i.uX)(),(0,i.CE)("div",D,[I,(0,i.Lk)("ul",F,[((0,i.uX)(!0),(0,i.CE)(i.FK,null,(0,i.pI)(l.models,(e=>((0,i.uX)(),(0,i.CE)("li",{key:e.id},[(0,i.Lk)("button",{class:"btn btn-success mt-2 model-button w-100",onClick:n=>a.load3DModel(e.downloadUrl)},(0,r.v_)(e.name),9,j)])))),128))])])):(0,i.Q3)("",!0)])):(0,i.Q3)("",!0),l.isAuthenticated?(0,i.Q3)("",!0):((0,i.uX)(),(0,i.CE)("div",S,[T,(0,i.Lk)("h1",X,(0,r.v_)(l.welcome)+" Visor VR",1),M,z,(0,i.Lk)("button",{class:"btn btn-primary w-100 mt-2",onClick:n[4]||(n[4]=(...e)=>a.login&&a.login(...e))},"Login")]))])])])],64)}t(4114);var H=t(75);const Q={auth:{clientId:"secrets.VUE_APP_CLIENT_ID",authority:"secrets.VUE_APP_AUTHORITY",redirectUri:"secrets.VUE_APP_REDIRECT_URI"},cache:{cacheLocation:"localStorage",storeAuthStateInCookie:!0}},q=new H.vq(Q),B=async()=>{await q.initialize()};var N=q,Z={name:"HomeView",data(){return{isAuthenticated:!1,username:"",modelUrl:"",models:[],welcome:"secrets.VUE_APP_WELCOME"}},async created(){await B(),this.checkAccount()},methods:{async login(){try{const e=await N.loginPopup({scopes:["User.Read","Files.Read"]});this.handleResponse(e)}catch(e){console.error("Login failed:",e)}},logout(){N.logoutPopup(),this.isAuthenticated=!1,this.username="",this.models=[]},handleResponse(e){if(e)this.isAuthenticated=!0,this.username=e.account.name;else{const e=N.getAllAccounts();1===e.length&&(this.isAuthenticated=!0,this.username=e[0].name)}},checkAccount(){const e=N.getAllAccounts();1===e.length&&(this.isAuthenticated=!0,this.username=e[0].name)},async getOneDriveFiles(){try{const e=N.getAllAccounts()[0],{accessToken:n}=await N.acquireTokenSilent({scopes:["Files.Read"],account:e}),t=await fetch("https://graph.microsoft.com/v1.0/me/drive/root:/models:/children",{headers:{Authorization:`Bearer ${n}`}});if(t.ok){const e=await t.json();this.models=e.value.map((e=>({id:e.id,name:e.name,downloadUrl:e["@microsoft.graph.downloadUrl"]})))}else console.error("Error fetching OneDrive files:",t.statusText)}catch(e){console.error("Error acquiring token or fetching files:",e)}},async load3DModel(e){e?(localStorage.setItem("modelUrl",e),this.$router.push({name:"model-viewer"})):console.error("Failed to load the model URL")}}};const $=(0,c.A)(Z,[["render",W],["__scopeId","data-v-38ce1a3f"]]);var J=$;const K={ref:"vrContainer",class:"vr-container"};function G(e,n,t,o,r,s){return(0,i.uX)(),(0,i.CE)("div",K,null,512)}var Y=t(8776),ee=t(1353),ne=t(4005),te=t(2951),oe={name:"VRModelViewer",data(){return{modelUrl:null}},mounted(){this.modelUrl=localStorage.getItem("modelUrl"),console.log(this.modelUrl),this.modelUrl?this.initVRScene():console.error("No model URL found.")},methods:{initVRScene(){const e=this.$refs.vrContainer,n=new Y.Z58,t=new Y.ubm(70,window.innerWidth/window.innerHeight,.1,1e3),o=new Y.JeP({antialias:!0});o.setSize(window.innerWidth,window.innerHeight),o.xr.enabled=!0,e.appendChild(o.domElement),e.appendChild(ne.Z.createButton(o)),t.position.set(0,10,10);const i=new Y.dth(16777215,12303359,2);i.position.set(.5,1,.25),n.add(i);const r=new ee.B;r.load(this.modelUrl,(e=>{const t=e.scene;t.position.set(0,1.6,0),n.add(t)}),void 0,(e=>{console.error("An error occurred while loading the GLB model:",e)}));const s=new te.N(t,o.domElement);s.enableDamping=!0,s.dampingFactor=.25,s.enableZoom=!0;const l=()=>{o.setAnimationLoop((()=>{s.update(),o.render(n,t)}))};l(),window.addEventListener("resize",(()=>{t.aspect=window.innerWidth/window.innerHeight,t.updateProjectionMatrix(),o.setSize(window.innerWidth,window.innerHeight)}))}}};const ie=(0,c.A)(oe,[["render",G],["__scopeId","data-v-f5b53836"]]);var re=ie;const se=[{path:"/",component:J},{path:"/scene",name:"model-viewer",component:re}],le=(0,h.aE)({history:(0,h.LA)("/VR-OneDrive/"),routes:se});var ae=le;(0,o.Ef)(u).use(ae).mount("#app")}},n={};function t(o){var i=n[o];if(void 0!==i)return i.exports;var r=n[o]={exports:{}};return e[o].call(r.exports,r,r.exports,t),r.exports}t.m=e,function(){var e=[];t.O=function(n,o,i,r){if(!o){var s=1/0;for(d=0;d<e.length;d++){o=e[d][0],i=e[d][1],r=e[d][2];for(var l=!0,a=0;a<o.length;a++)(!1&r||s>=r)&&Object.keys(t.O).every((function(e){return t.O[e](o[a])}))?o.splice(a--,1):(l=!1,r<s&&(s=r));if(l){e.splice(d--,1);var c=i();void 0!==c&&(n=c)}}return n}r=r||0;for(var d=e.length;d>0&&e[d-1][2]>r;d--)e[d]=e[d-1];e[d]=[o,i,r]}}(),function(){t.n=function(e){var n=e&&e.__esModule?function(){return e["default"]}:function(){return e};return t.d(n,{a:n}),n}}(),function(){t.d=function(e,n){for(var o in n)t.o(n,o)&&!t.o(e,o)&&Object.defineProperty(e,o,{enumerable:!0,get:n[o]})}}(),function(){t.g=function(){if("object"===typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"===typeof window)return window}}()}(),function(){t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)}}(),function(){t.p="/VR-OneDrive/"}(),function(){var e={524:0};t.O.j=function(n){return 0===e[n]};var n=function(n,o){var i,r,s=o[0],l=o[1],a=o[2],c=0;if(s.some((function(n){return 0!==e[n]}))){for(i in l)t.o(l,i)&&(t.m[i]=l[i]);if(a)var d=a(t)}for(n&&n(o);c<s.length;c++)r=s[c],t.o(e,r)&&e[r]&&e[r][0](),e[r]=0;return t.O(d)},o=self["webpackChunkmicrosoft_onedrive"]=self["webpackChunkmicrosoft_onedrive"]||[];o.forEach(n.bind(null,0)),o.push=n.bind(null,o.push.bind(o))}();var o=t.O(void 0,[504],(function(){return t(7179)}));o=t.O(o)})();
//# sourceMappingURL=app.3a218bdc.js.map